import{B as C}from"./BaseTitle.7b69d1b1.js";import{d as w}from"./default-avatar.7ca997ff.js";import{i as y,u as F,_ as S}from"./index.dbe1cbcb.js";import{l as A}from"./lodash.88cb4584.js";import{r as u,a6 as N,a9 as T,a7 as H,ao as M,c as j,o as d,f as _,g as t,F as x,i as B,k as s,h as i,U as D,_ as E,w as U,v as z,x as L,n as q,ad as b,t as k,Z as I}from"./vendor.e2990882.js";function P(){const a=u(!0),c=u(!1),l=u(),o=y(),r=F(),m=N(()=>o.messages),n=u("");T(()=>{o.init(r.userId);const e=l.value;e.addEventListener("scroll",A.exports.throttle(function(){e.scrollHeight-e.scrollTop>e.clientHeight+200?c.value=!1:c.value=!0},100))}),H(o.messages,async()=>{const e=l.value;await M();const V=e.clientHeight,f=e.scrollHeight,g=()=>{const h=e.scrollTop;if(Math.ceil(h)>=f-V){a.value=!1;return}e.scrollTo(0,h+Math.ceil(f-h)/100),requestAnimationFrame(g)};(a.value||c.value)&&requestAnimationFrame(g)});function p(e){n.value=e}function v(){const e={action:3,chat:{senderId:r.userId,receiverId:-1,content:n.value,sign:0},uuid:-1,createrId:null};o.send(e),n.value=""}return{messageBox:l,messages:m,user:r,sendValue:n,sendValueChangeValue:p,sendMessage:v}}const R=a=>(z("data-v-c0735a20"),a=a(),L(),a),W={class:"chat"},$={class:"chat-box"},Z={class:"chat-box-main"},G=R(()=>t("div",{class:"main-title"},"\u54B8\u8A00\u54B8\u8BED",-1)),J={class:"main-item-content"},K={class:"main-input"},O=I("\u53D1\u9001 \u{1F680}"),Q={class:"chat-box-user"},X={class:"user-title"},Y=I(" "+k("dokom")),ee=j({setup(a){const{messages:c,messageBox:l,user:o,sendValue:r,sendValueChangeValue:m,sendMessage:n}=P();return(p,v)=>(d(),_("div",W,[t("div",$,[t("div",Z,[G,t("ul",{ref_key:"messageBox",ref:l,class:"main-list"},[(d(!0),_(x,null,B(s(c),e=>(d(),_("li",{key:e.id,class:q(["main-item",s(o).userId==e.senderId?" self":""])},[i(s(b),{class:"main-avatar",size:36,round:"","object-fit":"cover",src:e.img_url?`http://112.74.108.218:8080/${e.img_url}`:s(w),"fallback-src":"/src/assets/image/bgc1.jpg"},null,8,["src"]),t("div",J,k(e.content),1)],2))),128))],512),t("div",K,[i(s(D),{placeholder:"\u5728\u6B64\u8F93\u5165\u5185\u5BB9",type:"textarea",autosize:{maxRows:3,minRows:1},maxlength:500,value:s(r),onUpdateValue:s(m)},null,8,["value","onUpdateValue"]),i(s(E),{onClick:s(n)},{default:U(()=>[O]),_:1},8,["onClick"])])]),t("div",Q,[t("div",X,[i(s(C),{title:"\u5F53\u524D\u5728\u7EBF 3"})]),(d(),_(x,null,B(3,e=>t("div",{key:e,class:"user-item"},[i(s(b),{round:"","object-fit":"cover",src:`http://112.74.108.218:8080/${123}`,"fallback-src":"/src/assets/image/bgc1.jpg"},null,8,["src"]),Y])),64))])])]))}});var ce=S(ee,[["__scopeId","data-v-c0735a20"]]);export{ce as default};
